# Mỗi dòng tương ứng với một port cần theo dõi.
# Định dạng: name|port|min_count|warning_sec|high_sec|no_alert
#
# Giải thích:
# - name:        Tên định danh (gọn, không dấu).
# - port:        Số port cần kiểm tra (vd: 80, 443, 3306).
# - min_count:   Số socket đang listen cần có (thường là 1).
# - warning_sec: Cảnh báo mức 1 nếu thiếu ≥ thời gian này (giây).
# - high_sec:    Cảnh báo mức 2 nếu thiếu ≥ thời gian này (giây).
# - no_alert:    1 = không cảnh báo, chỉ ghi nhận trạng thái.
#

#Luồng từ Zabbix server:

#1. Zabbix Server: Tạo Item với key port.check[<name>] (type: Zabbix agent).

#2. User Parameter trong zabbix_agentd.conf: UserParameter=port.check[*],/etc/zabbix/scripts/check_port.sh $1

#3. Script check_port.sh: Kiểm tra port listen qua ss -> Ghi log trạng thái (up/down) -> So sánh thời gian down với #warning_sec/high_sec.

#4. Trả về: 0 (OK), 1 (Warning), 2 (High), 3 (Lỗi config), 4 (Info - vừa down).

#5. Telegram: Nếu no_alert=0, Zabbix trigger gửi cảnh báo đến Telegram qua action.

# Ví dụ:
web_http|80|1|30|90|0
mysql_tcp|3306|1|60|180|0
testing|8080|0|0|0|1  # Không cảnh báo, chỉ theo dõi
